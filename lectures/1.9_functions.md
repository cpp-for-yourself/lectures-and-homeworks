---
marp: true
math: katex
theme: custom-theme
footer: ![width:80px](images/C++ForYourselfIcon.png)
---

# Functions introduction

#### Today:
- TODO

### ğŸ“º Watch the related [YouTube video](blah)! 

---
# Special symbols used in slides
- ğŸ¨ - Style recommendation
- ğŸ“ - Software design recommendation
- ğŸ˜± - **Not** a good practice! Avoid in real life!
- âœ… - Good practice!
- âŒ - Whatever is marked with this is wrong
- ğŸš¨ - Alert! Important information!
- ğŸ’¡ - Hint or a useful exercise
- ğŸ”¼1ï¸âƒ£7ï¸âƒ£ - Holds for this version of C++(here, `17`) and **above**
- ğŸ”½1ï¸âƒ£1ï¸âƒ£ - Holds for versions **until** this one C++(here, `11`)

Style (ğŸ¨) and software design (ğŸ“) recommendations mostly come from [Google Style Sheet](https://google.github.io/styleguide/cppguide.html) and the [CppCoreGuidelines](https://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines)

---
# Functions
- Code can be organized into functions that look like this:
  ```cpp
  ReturnType FuncName(ParamType1 in_1, ParamType2 in_2) {
    // Some awesome code here.
    return return_value;
  }
  ```
- Functions **create a [scope](1.2_cpp_basic_types_and_variables.md#all-variables-live-in-scopes)**
- There is a **single return value** from a function
- If the `ReturnType` is `void` --- no `return` is needed
- ğŸ“â€¼ï¸ [**Write short functions**](https://google.github.io/styleguide/cppguide.html#Write_Short_Functions) --- they must do **one thing only**
- ğŸ¨ Name **must** show what the function does
- ğŸ¨ Name functions in `CamelCase`
- ğŸ¨ Use `snake_case` for all function arguments
- ğŸ¨ Name should have a verb in it

---
# Good function example
```cpp
#include <vector>
using std::vector;

vector<int> CreateFibonacciSequence(std::size_t length) {
  // Vector of size `length`, filled with 0s.
  vector<int> result(length, 1);
  if (length < 3) { return result; }
  for (auto i = 2UL; i < length; ++i) {
    result[i] = result[i - 1UL] + result[i - 2UL];
  }
  return result;
}

int main() {
  const auto fibonacci_sequence = CreateFibonacciSequence(10UL);
  // Do something with fibonacci_sequence.
  return 0;
}
```
- Is small enough to see all the code at once
- Name clearly states what the function does
- Function **does a single thing**

---
# :scream: Bad function example
```cpp
#include <vector>
using std::vector;

vector<std::size_t> Func(std::size_t a, bool b) {
  if (b) { return vector<std::size_t>(10, a); }
  vector<std::size_t> vec(a);
  for (auto i = 0UL; i < a; ++i) { vec[i] = a * i; }
  if (vec.size() > a * 2) { vec[a] /= 2.0f; }
  return vec;
}

int main() {
  const auto smth = Func(10, true);
  // Do smth with smth.
  return 0;
}
```
- Name of the function means nothing
- Names of variables mean nothing
- Function does not have a single purpose
- It is **really** hard to understand what it does at a glance!

---
# Declaration vs definition
- Function declaration can be separated from the implementation details
- Function **declaration** sets up an interface
  ```cpp
  void FuncName(int param);
  ```
- Function **definition** holds the implementation of the function that can even be hidden from the user
  ```cpp
  void FuncName(int param) {
    // Implementation details.
    cout << "This function is called FuncName! ";
    cout << "Did you expect anything useful from it?";
  }
  ```

---
# Passing big objects
- By default in C++, objects are copied when passed into functions
- If objects are big (i.e., **not** [fundamental](1.2_cpp_basic_types_and_variables.md#variables-of-fundamental-types)) it might be slow
- **Pass by reference** to avoid copying lots of data
  ```cpp
  void DoSmth(std::string huge_string);          // Slow.
  void DoSmthWithRef(std::string& huge_string);  // Faster.
  ```
- Is the string still the same?
  ```cpp
  std::string hello = "some_important_long_string";
  DoSmthWithRef(hello);
  ```
- :scream: **Unknown** without looking into `DoSmthWithRef` code!

---
![center width:800](images/pass_by_ref.gif)

I'll change the function `fillCup` to `Fill` in the examples

<div class="grid-container">
<div>

### Pass by reference:
- `void Fill(Cup &cup);`
- `cup` is full afterwards
  
</div>

<div>

### Pass by value:
- `void Fill(Cup cup);`
- A **copy** of `cup` is full
- `cup` is still empty
  
</div>


---
# Solution: use const references
- Pass `const` reference to the function
- Great speed as we pass a reference
- Passed object stays intact, guaranteed!
  ```cpp
  void DoSmth(const std::string& huge_string);
  ```
- Non-`const` references are mostly used in older code written before C++11
- ğŸ”¼1ï¸âƒ£1ï¸âƒ£ Returning from function is _mostly_ fast
- ğŸ”¼1ï¸âƒ£7ï¸âƒ£ Returning from function is _always_ fast
- ğŸ“ğŸ¨ Avoid using non-`const` references, see [Google style](https://google.github.io/styleguide/cppguide.html#Inputs_and_Outputs)
- ğŸ’¡ Sometimes passing by non-const reference is still faster than returning from a function. Measure before doing this!


---
# Function overloading
- Compiler infers a function from arguments
- Cannot overload based on return type
- Return type plays no role at all
  ```cpp
  #include <iostream>
  #include <string>
  using std::cout;
  using std::endl;
  std::string Func(int num) { return "int"; }
  std::string Func(const std::string& str) { return "string"; }
  int main() {
    cout << Func(1) << endl;
    cout << Func("hello") << endl;
    return 0;
  }
  ```
- ğŸ“ [Avoid non-obvious overloads](https://google.github.io/styleguide/cppguide.html#Function_Overloading)

---
# ğŸ¤” Use default arguments?
- Only **set in declaration** not in definition
- **Pros:** simplify _some_ function calls
- **Cons:**
  - Evaluated upon every call
  - Values are hidden in declaration
  - Can lead to unexpected behavior when overused
- ğŸ“ [Only use them when readability gets much better](https://google.github.io/styleguide/cppguide.html#Default_Arguments)


---
# Example: default arguments
```cpp
#include <iostream>
using std::string;
using std::cout;
using std::endl;
string SayHello(const string& to_whom = "world") {
  return "Hello " + to_whom + "!";
}
int main() {
  cout << SayHello() << endl;
  cout << SayHello("students") << endl;
  return 0;
}
```

---
# Talk about `noexcept`
Maybe?
---
